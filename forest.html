<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Realistic Terrain Map Generator</title>

<style>
body {
    margin: 0;
    background: #dddddd;
    font-family: Arial, sans-serif;
    text-align: center;
}

h1 {
    margin: 12px;
}

canvas {
    border: 3px solid #333;
    background: #7fb3e6;
    max-width: 95%;
}

.controls {
    margin: 10px;
}

button, select {
    padding: 10px 14px;
    margin: 5px;
    font-size: 15px;
    cursor: pointer;
}
</style>
</head>

<body>

<h1>üåç Realistic Terrain Map Generator</h1>

<canvas id="map" width="900" height="600"></canvas>

<div class="controls">
    <button onclick="generateMap()">Generate New Map</button>

    <select id="snowMode" onchange="generateMap()">
        <option value="auto">Snow: Auto (Realistic)</option>
        <option value="always">Snow: Always</option>
        <option value="none">Snow: None</option>
    </select>

    <button onclick="downloadMap()">Download PNG</button>
    <button onclick="window.location.href='index.html'">‚¨ÖÔ∏è Back to Map Hub</button>
</div>

<script>
const canvas = document.getElementById("map");
const ctx = canvas.getContext("2d");
const W = canvas.width;
const H = canvas.height;

/* ---------- SMOOTH NOISE ---------- */
function noise(x, y, seed) {
    return Math.sin(x * 0.015 + y * 0.02 + seed) * 0.5 + 0.5;
}

/* ---------- MAP GENERATION ---------- */
function generateMap() {
    const seed = Math.random() * 1000;
    const snowMode = document.getElementById("snowMode").value;
    const image = ctx.createImageData(W, H);

    for (let y = 0; y < H; y++) {
        for (let x = 0; x < W; x++) {

            // normalized position
            let nx = x / W - 0.5;
            let ny = y / H - 0.5;
            let distance = Math.sqrt(nx * nx + ny * ny);

            // elevation
            let e =
                noise(x, y, seed) * 0.6 +
                noise(x * 2, y * 2, seed) * 0.4;

            // continent shaping
            e -= distance * 1.15;

            let r, g, b;

            // water
            if (e < 0.28) {
                r = 40; g = 90; b = 160;
            }
            // land
            else if (e < 0.48) {
                r = 70; g = 150; b = 80;
            }
            // dirt / hills
            else if (e < 0.65) {
                r = 145; g = 120; b = 85;
            }
            // mountains / snow decision
            else {
                let snow =
                    snowMode === "always" ||
                    (snowMode === "auto" && e > 0.72);

                if (snowMode === "none") snow = false;

                if (snow) {
                    r = 245; g = 245; b = 245;
                } else {
                    r = 130; g = 110; b = 95;
                }
            }

            const i = (x + y * W) * 4;
            image.data[i] = r;
            image.data[i + 1] = g;
            image.data[i + 2] = b;
            image.data[i + 3] = 255;
        }
    }

    ctx.putImageData(image, 0, 0);
}

/* ---------- DOWNLOAD ---------- */
function downloadMap() {
    const a = document.createElement("a");
    a.download = "terrain_map.png";
    a.href = canvas.toDataURL("image/png");
    a.click();
}

generateMap();
</script>

</body>
</html>